import{y as s,m as S,o as x,c as N,w as a,G as T,H as l,a as e,I as n,ai as w,K as p,aj as V,a8 as y}from"./index.55ec1fa1.js";import{Q as $}from"./QSpinnerDots.00537bd1.js";import{Q as z,a as G,b,c as L}from"./QTable.a9ca3087.js";import{Q as H,b as Q,a as I}from"./QPage.116c91c2.js";import{Q as R,a as E,C as _}from"./ClosePopup.4b52164a.js";import{u as M}from"./use-quasar.485ffa18.js";import{u as P}from"./laporan-store.890fae49.js";import"./format.03fbf766.js";import"./selection.d802a799.js";import"./QList.bdc0d16e.js";import"./use-key-composition.9a8b945e.js";const j={class:"q-pa-md"},K={class:"row q-mb-md"},U={class:"col-auto"},la={__name:"LaporanList",setup(F){const k=T(),i=M(),c=P(),d=s(!1),m=s([]),u=s(!1),f=s(null),C=[{name:"nomorBarang",required:!0,label:"Nomor Barang",align:"left",field:"nomorBarang",sortable:!0},{name:"namaBarang",required:!0,label:"Nama Barang",align:"left",field:"namaBarang",sortable:!0},{name:"noSurat",required:!0,label:"Nomor Surat",align:"left",field:"noSurat",sortable:!0},{name:"createdAt",required:!0,label:"Tanggal Dibuat",align:"left",field:"createdAt",sortable:!0},{name:"actions",required:!0,label:"Aksi",align:"center",field:"actions"}],D=o=>new Date(o).toLocaleDateString("id-ID"),g=async()=>{d.value=!0;try{const o=await c.getAllLaporan();m.value=o}catch(o){console.error("Error loading laporan list:",o),i.notify({type:"negative",message:"Gagal memuat daftar laporan"})}finally{d.value=!1}},v=o=>{k.push(`/${o.id}`)},B=(o,t)=>{v(t)},q=o=>{f.value=o,u.value=!0},h=async()=>{try{await c.deleteLaporan(f.value.id),await g(),i.notify({type:"positive",message:"Laporan berhasil dihapus"})}catch(o){console.error("Error deleting laporan:",o),i.notify({type:"negative",message:"Gagal menghapus laporan"})}};return S(()=>{g()}),(o,t)=>(x(),N(H,{padding:""},{default:a(()=>[l("div",j,[l("div",K,[t[1]||(t[1]=l("div",{class:"col"},[l("div",{class:"text-h6"},"Daftar Laporan")],-1)),l("div",U,[e(n,{color:"primary",icon:"add",label:"Buat Laporan",to:"/create"})])]),e(Q,null,{default:a(()=>[e(z,{rows:m.value,columns:C,"row-key":"id",loading:d.value,onRowClick:B},{loading:a(()=>[e(G,{showing:"",color:"primary"},{default:a(()=>[e($,{size:"50px"})]),_:1})]),"no-data":a(()=>t[2]||(t[2]=[l("div",{class:"full-width row flex-center q-pa-md text-grey"}," Tidak ada data laporan ",-1)])),"body-cell-actions":a(r=>[e(b,{props:r},{default:a(()=>[e(n,{flat:"",round:"",color:"primary",icon:"visibility",size:"sm",onClick:w(A=>v(r.row),["stop"])},{default:a(()=>[e(L,null,{default:a(()=>t[3]||(t[3]=[p("Lihat Detail")])),_:1})]),_:2},1032,["onClick"]),e(n,{flat:"",round:"",color:"negative",icon:"delete",size:"sm",onClick:w(A=>q(r.row),["stop"])},{default:a(()=>[e(L,null,{default:a(()=>t[4]||(t[4]=[p("Hapus")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),"body-cell-createdAt":a(r=>[e(b,{props:r},{default:a(()=>[p(V(D(r.row.createdAt)),1)]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1})]),e(E,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=r=>u.value=r),persistent:""},{default:a(()=>[e(Q,null,{default:a(()=>[e(I,{class:"row items-center"},{default:a(()=>t[5]||(t[5]=[l("span",{class:"q-ml-sm"},"Apakah Anda yakin ingin menghapus laporan ini?",-1)])),_:1}),e(R,{align:"right"},{default:a(()=>[y(e(n,{flat:"",label:"Batal",color:"primary"},null,512),[[_]]),y(e(n,{flat:"",label:"Hapus",color:"negative",onClick:h},null,512),[[_]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{la as default};
